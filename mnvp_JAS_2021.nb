(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33753,        748]
NotebookOptionsPosition[     30775,        704]
NotebookOutlinePosition[     31332,        724]
CellTagsIndexPosition[     31289,        721]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 StyleBox[
  RowBox[{"Data", ";"}], "Section"]], "Input",
 CellChangeTimes->{{3.6712849561352196`*^9, 3.67128495613722*^9}, 
   3.6712850858109474`*^9, 3.7861162848133993`*^9},
 CellLabel->
  "In[275]:=",ExpressionUUID->"84e9788a-9fe1-4f04-a8c7-0e72f074e507"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", "48"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Data", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Control", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{"{", 
      RowBox[{"25", ",", " ", "38"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"xvector", "=", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Treatment", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", " ", 
   RowBox[{"{", 
    RowBox[{"16", ",", " ", "30"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xvector", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", " ", "0"}], "}"}]}], ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.607671943570907*^9, 3.607671954963749*^9}, {
   3.607701656700122*^9, 3.607701684232065*^9}, {3.607753051683177*^9, 
   3.607753076310388*^9}, {3.644042315557949*^9, 3.6440423511885242`*^9}, {
   3.644042486339232*^9, 3.64404249286499*^9}, {3.644043216139226*^9, 
   3.6440432349428387`*^9}, {3.644043741699011*^9, 3.644043742256227*^9}, {
   3.6440474793831873`*^9, 3.644047481006545*^9}, {3.6440704201443834`*^9, 
   3.6440704705168724`*^9}, {3.6440707403349457`*^9, 
   3.6440707406313467`*^9}, {3.644215091881286*^9, 3.644215131676956*^9}, {
   3.6442221421652107`*^9, 3.644222181818532*^9}, {3.644222327887113*^9, 
   3.644222354119438*^9}, {3.644300586592394*^9, 3.644300613625085*^9}, {
   3.6443008121690493`*^9, 3.644300816181941*^9}, {3.644307929186553*^9, 
   3.6443079488306017`*^9}, {3.6443081551831303`*^9, 3.644308159072792*^9}, {
   3.6712613167895412`*^9, 3.6712613724528894`*^9}, {3.6712617581428213`*^9, 
   3.6712617655100265`*^9}, {3.6712619089874773`*^9, 
   3.6712619104815392`*^9}, {3.6712622798624983`*^9, 
   3.6712622836641994`*^9}, {3.671262320810191*^9, 3.6712623300477247`*^9}, {
   3.6712645417692313`*^9, 3.6712645424086857`*^9}, {3.6712646635515194`*^9, 
   3.6712646645652404`*^9}, {3.6712652290634317`*^9, 3.671265229373652*^9}, {
   3.6712669155884304`*^9, 3.671266919391133*^9}, {3.6712781330208163`*^9, 
   3.67127813460194*^9}, {3.6712782623162613`*^9, 3.671278268936491*^9}, {
   3.671278445195733*^9, 3.6712784767168055`*^9}, {3.671278700840498*^9, 
   3.671278715529191*^9}, {3.6712789599867954`*^9, 3.6712789981204824`*^9}, {
   3.67128117558055*^9, 3.6712811765812616`*^9}, {3.6712812819049244`*^9, 
   3.6712812849891443`*^9}, {3.671281332334569*^9, 3.671281334076838*^9}, {
   3.671281387873252*^9, 3.6712814321411114`*^9}, {3.671281514137439*^9, 
   3.671281531240591*^9}, {3.671281563858703*^9, 3.6712816058912477`*^9}, {
   3.6712848890582*^9, 3.6712848996997547`*^9}, {3.671285317643751*^9, 
   3.671285326555083*^9}, {3.671289766793427*^9, 3.671289790796929*^9}, {
   3.671301611361467*^9, 3.6713016585559964`*^9}, 3.6713049560169497`*^9, {
   3.6714235625785627`*^9, 3.671423579401038*^9}, {3.671425004115014*^9, 
   3.6714250087052765`*^9}, {3.6714345599735355`*^9, 
   3.6714345857706385`*^9}, {3.671441579691572*^9, 3.6714415853947434`*^9}, {
   3.671441821224723*^9, 3.6714418246779013`*^9}, {3.6714418548343935`*^9, 
   3.6714418561469035`*^9}, {3.671442064945444*^9, 3.6714420658985767`*^9}, {
   3.6714426030434647`*^9, 3.671442603840347*^9}, {3.671442761576008*^9, 
   3.6714427839355354`*^9}, {3.671442939577424*^9, 3.6714430235155973`*^9}, {
   3.671443088969244*^9, 3.671443089203621*^9}, {3.67144327658009*^9, 
   3.671443276720696*^9}, {3.671443380221569*^9, 3.671443442956419*^9}, {
   3.6714437972405233`*^9, 3.6714439311478176`*^9}, {3.671444612762658*^9, 
   3.6714446435910077`*^9}, {3.671444737388628*^9, 3.6714447403574014`*^9}, {
   3.671444908374369*^9, 3.6714449136400614`*^9}, {3.6714449674686155`*^9, 
   3.6714450280003233`*^9}, {3.671445236048886*^9, 3.6714452410488806`*^9}, {
   3.671448322067911*^9, 3.6714483284742365`*^9}, {3.6714502485833144`*^9, 
   3.671450271427223*^9}, {3.671451265893755*^9, 3.6714512853470087`*^9}, {
   3.6714514372075977`*^9, 3.6714514517233624`*^9}, {3.671455783893382*^9, 
   3.6714558559095564`*^9}, {3.6714561744746037`*^9, 3.671456227365672*^9}, {
   3.6714563331321173`*^9, 3.671456443789219*^9}, {3.671456782276326*^9, 
   3.671456855886289*^9}, {3.6714583237408047`*^9, 3.6714583430504293`*^9}, {
   3.6717843240724907`*^9, 3.671784356057086*^9}, {3.671784389557364*^9, 
   3.6717843896979895`*^9}, {3.6717844355108557`*^9, 
   3.6717844454796853`*^9}, {3.6717851120318794`*^9, 3.671785128360135*^9}, 
   3.6717858701160374`*^9, {3.671790466387627*^9, 3.6717904833998203`*^9}, {
   3.671790731392844*^9, 3.6717907403822236`*^9}, 3.6718652268034167`*^9, {
   3.6883281139732985`*^9, 3.688328129818631*^9}, {3.6883282257954035`*^9, 
   3.688328229592403*^9}, {3.6883289588523035`*^9, 3.6883289786502914`*^9}, {
   3.6883290361649494`*^9, 3.688329298072419*^9}, {3.6883298499696164`*^9, 
   3.6883298504383903`*^9}, {3.6883304706285367`*^9, 3.688330472613145*^9}, {
   3.6883305189317856`*^9, 3.688330551070445*^9}, {3.6883306197406073`*^9, 
   3.6883306509814167`*^9}, {3.6883322794489794`*^9, 3.688332300155143*^9}, {
   3.6883370856172276`*^9, 3.688337085742282*^9}, {3.6883656512674236`*^9, 
   3.688365672892556*^9}, {3.688369519383156*^9, 3.6883695206800413`*^9}, {
   3.688369820354394*^9, 3.6883698610578566`*^9}, 3.688372608018067*^9, {
   3.6883731835072002`*^9, 3.688373183741577*^9}, 3.688378839632089*^9, {
   3.696139425534914*^9, 3.6961394257039237`*^9}, {3.6961443119043984`*^9, 
   3.6961443157686195`*^9}, {3.696145160677945*^9, 3.696145240801528*^9}, 
   3.6961454313304257`*^9, 3.696259016953905*^9, {3.696335187819291*^9, 
   3.6963351904526696`*^9}, {3.696351202381668*^9, 3.6963512030067472`*^9}, 
   3.696404203557623*^9, {3.696503791548874*^9, 3.6965037916270056`*^9}, 
   3.6965384479231977`*^9, {3.773472964128195*^9, 3.7734730262887497`*^9}, {
   3.773473174360219*^9, 3.7734731794895124`*^9}, {3.7734737566135225`*^9, 
   3.773473760489744*^9}, {3.7734738620745544`*^9, 3.773473864770708*^9}, {
   3.7734739020338397`*^9, 3.773473904537983*^9}, {3.773473969034672*^9, 
   3.7734739712808003`*^9}, {3.7734772280600777`*^9, 
   3.7734772515004187`*^9}, {3.784651339265009*^9, 3.784651411836485*^9}, {
   3.784652542275894*^9, 3.78465255052048*^9}, {3.784654750550579*^9, 
   3.784654758334383*^9}, {3.784706756304413*^9, 3.784706769521866*^9}, {
   3.784708058703186*^9, 3.784708078141642*^9}, {3.784727669101244*^9, 
   3.784727679754095*^9}, {3.7847284006649942`*^9, 3.7847284120372543`*^9}, {
   3.7847288160894127`*^9, 3.7847288251326857`*^9}, {3.785257478615991*^9, 
   3.7852574884807367`*^9}, {3.7861163854178333`*^9, 3.786116389905554*^9}, {
   3.786116440025758*^9, 3.786116613626058*^9}, {3.83646019568747*^9, 
   3.836460212093072*^9}, {3.83646039616617*^9, 3.836460396359188*^9}, {
   3.836460897637847*^9, 3.836460899701378*^9}, {3.836462734013997*^9, 
   3.836462761533085*^9}, {3.836542641311967*^9, 3.836542651183083*^9}, {
   3.8365429117848167`*^9, 3.836542920850355*^9}, {3.83656838985892*^9, 
   3.8365684115589027`*^9}, {3.8365687322468*^9, 3.836568758380415*^9}, {
   3.837496338966538*^9, 3.837496362961379*^9}, {3.837496460873719*^9, 
   3.837496482460889*^9}, {3.837497132059615*^9, 3.837497161634611*^9}, {
   3.8374972350661507`*^9, 3.837497282293256*^9}, {3.8374975083567457`*^9, 
   3.837497519975473*^9}, {3.8437144870928497`*^9, 3.843714496359313*^9}, {
   3.843715206675487*^9, 3.8437152291094007`*^9}, {3.843715262101132*^9, 
   3.843715282094844*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"265b960a-c5c1-459e-b1ee-f306a34ad1dc"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Partitions", ";"}], "Section"]], "Input",
 CellChangeTimes->{{3.67128505441054*^9, 3.671285057109481*^9}, 
   3.671285106860499*^9, {3.786116294404714*^9, 3.786116294965177*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"6ba73300-d440-4151-bfb0-a9bbfb27dad0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Combinatorica`\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{3.67128524300325*^9},
 CellLabel->
  "In[119]:=",ExpressionUUID->"f723fa7e-d9f5-43ec-9982-9a0981e80daa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", " ", 
   RowBox[{"Length", "[", "xvector", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"models", " ", "=", " ", 
   RowBox[{"SetPartitions", "[", "k", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Numberofmodels", " ", "=", " ", 
   RowBox[{"Length", "[", "models", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kpartitions", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"KSetPartitions", "[", 
      RowBox[{"k", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
    RowBox[{"Range", "[", "k", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Numbersubgroups1", " ", "=", " ", 
   RowBox[{"Length", " ", "/@", " ", "kpartitions"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Numbersubgroups2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"Length", " ", "/@", " ", 
        RowBox[{"Partitions", "[", "k", "]"}]}], ",", " ", "#"}], "]"}], " ", 
     "&"}], " ", "/@", " ", 
    RowBox[{"Range", "[", "k", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.671281521580756*^9, {3.671285066369028*^9, 3.6712850721031876`*^9}, {
   3.6713015268604326`*^9, 3.671301537083701*^9}, {3.6714483522869024`*^9, 
   3.6714484031935835`*^9}, {3.671449186027933*^9, 3.6714492149813137`*^9}, 
   3.6714504406215153`*^9, 3.688329310745245*^9, {3.6883306785174985`*^9, 
   3.6883306817990522`*^9}, {3.773473256178899*^9, 3.7734732894998045`*^9}, 
   3.7734733220496664`*^9, {3.773473504355094*^9, 3.773473556948102*^9}, 
   3.773476668750087*^9, 3.784708089764724*^9},
 CellLabel->
  "In[120]:=",ExpressionUUID->"dc95f351-a071-4460-a7af-00a4291e3458"],

Cell[BoxData[
 RowBox[{
  RowBox[{"modelsLengths", " ", "=", " ", 
   RowBox[{"Sort", " ", "/@", " ", 
    RowBox[{"Map", "[", 
     RowBox[{"Length", ",", " ", "models", ",", " ", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6712854308816338`*^9, 3.671285432558826*^9}, 
   3.671301545692812*^9, {3.67144844474079*^9, 3.6714484600534134`*^9}, {
   3.671449227372013*^9, 3.6714492332158346`*^9}, {3.7734735614333587`*^9, 
   3.7734735763702126`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"202d8811-faf5-4ef7-b56c-bbd1f164b1d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xbuenos", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"xvector", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], ",", " ", "models",
      ",", " ", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"nbuenos", " ", "=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"n", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], ",", " ", 
      "models", ",", " ", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}]}], "Input",
 CellChangeTimes->{{3.7734739989813848`*^9, 3.7734740368995533`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"9da70d02-c61e-415e-bdb6-c15c5368fef1"],

Cell[TextData[StyleBox["Marginals;", "Section"]], "Text",
 CellChangeTimes->{{3.6712857254698887`*^9, 3.6712857271170597`*^9}, 
   3.6713044709476147`*^9, 
   3.786116306895817*^9},ExpressionUUID->"43284547-e832-4a8f-a6d3-\
35116f3472d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"x_", ",", " ", "n_", ",", " ", "t_", ",", " ", "zeta_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", " ", "+", " ", "t"}], ")"}], " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"x", "+", "1"}], "]"}], "*", 
      RowBox[{
       RowBox[{"Gamma", "[", 
        RowBox[{"n", "+", "t", "-", "x", "+", "1"}], "]"}], "/", 
       RowBox[{"Gamma", "[", 
        RowBox[{"n", "+", "t", "+", "2"}], "]"}]}]}], ")"}], "*", 
    RowBox[{"HypergeometricPFQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "t"}], ",", " ", 
        RowBox[{"-", "t"}], ",", " ", 
        RowBox[{"1", "+", "x"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"-", "n"}], "-", "t", "+", "x"}]}], "}"}], ",", 
      RowBox[{"zeta", "/", 
       RowBox[{"(", 
        RowBox[{"zeta", " ", "-", " ", "1"}], ")"}]}]}], "]"}], "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "zeta"}], ")"}], "^", "t"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"x_List", ",", " ", "n_List", ",", " ", "t_", ",", " ", "zeta_"}],
     "]"}], " ", ":=", " ", 
   RowBox[{"Product", "[", 
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"n", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "t", ",", " ", "zeta"}], "]"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Predictiva", "[", 
    RowBox[{"x_", ",", "n_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"10", "^", "1000"}], "*", 
      RowBox[{"G", "[", 
       RowBox[{"x", ",", "n", ",", "t", ",", "zeta"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"zeta", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pred", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Predictiva", "[", 
     RowBox[{"x", ",", "n", ",", "t0"}], "]"}], "/", 
    RowBox[{"10", "^", "1000"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671285768110817*^9, 3.671285769728965*^9}, {
   3.6712858240128255`*^9, 3.6712858381548347`*^9}, {3.671286493951829*^9, 
   3.671286500817736*^9}, {3.6712876346785665`*^9, 3.671287684670252*^9}, {
   3.67129318898901*^9, 3.6712931907232428`*^9}, {3.6712934472321415`*^9, 
   3.671293448251866*^9}, 3.671293511004531*^9, {3.6712935623938723`*^9, 
   3.671293563268516*^9}, {3.671294538771988*^9, 3.671294569687954*^9}, {
   3.671294607932448*^9, 3.6712946234399834`*^9}, {3.6712952208692164`*^9, 
   3.671295230518073*^9}, 3.6712952725201445`*^9, {3.671295419940702*^9, 
   3.671295422218322*^9}, {3.671295484865717*^9, 3.6712955001193113`*^9}, {
   3.6712955335780816`*^9, 3.671295535661562*^9}, {3.6712955681955404`*^9, 
   3.6712955930167313`*^9}, {3.671295639243432*^9, 3.6712956510097947`*^9}, {
   3.671430699073618*^9, 3.671430702175824*^9}, {3.6714415564413605`*^9, 
   3.6714415894572477`*^9}, {3.6714416635515594`*^9, 
   3.6714416658484526`*^9}, {3.671441764380546*^9, 3.671441767771197*^9}, {
   3.6714487079303913`*^9, 3.6714488304157443`*^9}, {3.6714499096899843`*^9, 
   3.6714499149243765`*^9}, {3.671450649154454*^9, 3.671450649748184*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"f6f6e041-3b83-4b9b-9bc3-6312c89cdbe2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Marginals", " ", "=", 
   RowBox[{"Parallelize", "[", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Pred", ",", " ", 
      RowBox[{"{", 
       RowBox[{"xbuenos", ",", " ", "nbuenos"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.671285890865517*^9, {3.671295333806898*^9, 3.671295336026475*^9}, 
   3.6713015616321654`*^9, {3.6714294937767086`*^9, 3.6714294978236046`*^9}, 
   3.6714296066241884`*^9, 3.671430308264121*^9, {3.6714484972255597`*^9, 
   3.6714485318977103`*^9}, {3.68832827057922*^9, 3.6883282710323515`*^9}, {
   3.688329345951454*^9, 3.6883293537960677`*^9}, {3.6883308416818914`*^9, 
   3.688330867764793*^9}, {3.77347363978684*^9, 3.7734736711616344`*^9}, {
   3.7734740681383405`*^9, 3.773474109411701*^9}, 3.8364622707977324`*^9, 
   3.837497541689872*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"0669bf90-4739-4f97-aefd-f4afaec63a2c"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"Prior", " ", "probabilities"}], ";"}], "Section"]], "Input",
 CellChangeTimes->{{3.6712991287976685`*^9, 3.671299136166895*^9}, 
   3.671304473982802*^9, {3.786116317568912*^9, 3.786116320570557*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"1cb5b4e4-97c8-45b4-925f-1c5ac3763b33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Prob1Groups", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"1", "/", "k"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "k"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6712853999906597`*^9, 3.6712854041176195`*^9}, 
   3.671301565531907*^9, 3.773474152802183*^9, 3.773474204171121*^9},
 CellLabel->
  "In[135]:=",ExpressionUUID->"39de7ffb-8297-40da-9311-6ddd05473359"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Prob1", " ", "=", " ", 
   RowBox[{"Prob1Groups", "[", 
    RowBox[{"[", 
     RowBox[{"Length", " ", "/@", " ", "models"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"Prob2", " ", "=", " ", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"Numbersubgroups2", "[", 
       RowBox[{"[", 
        RowBox[{"Length", " ", "/@", " ", "models"}], "]"}], "]"}], ")"}]}]}],
    ";"}]}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"modelsLengths", " ", "=", " ", 
    RowBox[{"Sort", " ", "/@", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"Length", ",", " ", "models", ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}]}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"Prob3", " ", "=", " ", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"modelsLengths", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@",
        " ", "modelsLengths"}], ")"}]}]}], ";"}]}], "\n", 
 RowBox[{
  RowBox[{"Probini", " ", "=", " ", 
   RowBox[{"Prob1", "*", "Prob2", "*", "Prob3"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6712991977567296`*^9, 3.6712992406033278`*^9}, {
   3.6712993176567297`*^9, 3.6712993211872163`*^9}, {3.6712993765442486`*^9, 
   3.6712993776370535`*^9}, {3.6712995677200356`*^9, 3.671299568410549*^9}, {
   3.6713015697368984`*^9, 3.671301579276676*^9}, {3.6714491397775354`*^9, 
   3.671449142090082*^9}, {3.688328324832674*^9, 3.6883284152845807`*^9}, {
   3.6883284822415915`*^9, 3.688328607633202*^9}, {3.6883297611597953`*^9, 
   3.688329762097308*^9}, {3.7734741563403854`*^9, 3.773474184605002*^9}, {
   3.7734772732876644`*^9, 3.7734772806620865`*^9}, 3.836462345046137*^9, 
   3.837497535896944*^9},
 CellLabel->
  "In[136]:=",ExpressionUUID->"d0c5718f-8d59-4603-a9c9-72d4d4bb03e7"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"Posterior", " ", "probabilities"}], ";"}], "Section"]], "Input",
 CellChangeTimes->{{3.6712997283955865`*^9, 3.6712997323193526`*^9}, 
   3.6713044763844795`*^9, {3.786116325274806*^9, 3.7861163358606863`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"ca094328-2d2e-4279-b3e6-a33b821335e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"posterior1", "=", 
   RowBox[{"Probini", "*", "Marginals"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posterior", "=", 
   RowBox[{"posterior1", "/", 
    RowBox[{"Total", "[", "posterior1", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6712997443929515`*^9, 3.6712997661904373`*^9}, 
   3.6713015868770714`*^9, {3.6714490749176474`*^9, 3.671449090074068*^9}, {
   3.671449147152648*^9, 3.671449150793302*^9}, {3.6883286217747903`*^9, 
   3.6883286224310484`*^9}, {3.6883288330243063`*^9, 
   3.6883288773396044`*^9}, {3.6883293978775005`*^9, 3.688329404331008*^9}, {
   3.6883297014941416`*^9, 3.688329702291029*^9}, {3.688329748768391*^9, 
   3.6883297955053697`*^9}, {3.6883317172927904`*^9, 3.688331797736704*^9}, {
   3.688331830883445*^9, 3.6883318312120056`*^9}, {3.688332196857006*^9, 
   3.688332197419515*^9}, {3.6883784014097166`*^9, 3.6883784090035276`*^9}, {
   3.6883785162231655`*^9, 3.688378534692069*^9}, {3.688378696240279*^9, 
   3.688378696599657*^9}, {3.7734742277314687`*^9, 3.7734742417472706`*^9}, {
   3.7734743019937162`*^9, 3.7734743063889675`*^9}, 3.7734744180503545`*^9, {
   3.7734744656580772`*^9, 3.7734745938664103`*^9}, {3.773477170068761*^9, 
   3.7734771705327873`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"9e29cdf6-b450-4790-90ef-f67003946c94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Riffle", "[", 
      RowBox[{"posterior", ",", "models"}], "]"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"results", " ", "=", " ", 
  RowBox[{"Sort", "[", 
   RowBox[{"result", ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", 
      RowBox[{"#2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", "&"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.671299851781269*^9, 3.6712999014585686`*^9}, 
   3.671300020409418*^9, {3.6713015954811845`*^9, 3.6713015973765306`*^9}, {
   3.671375299591567*^9, 3.671375309546669*^9}, {3.6714491300900106`*^9, 
   3.67144915562144*^9}, {3.671449298856985*^9, 3.6714493105445523`*^9}, {
   3.671450319808027*^9, 3.6714503199486775`*^9}, {3.6714503521520863`*^9, 
   3.671450352589589*^9}, {3.6883286380575624`*^9, 3.68832864558916*^9}, {
   3.6883294157539577`*^9, 3.6883294223951254`*^9}, {3.6883328753354206`*^9, 
   3.688332915279869*^9}, {3.688336243767473*^9, 3.6883362488622313`*^9}, {
   3.773474604572023*^9, 3.773474656499993*^9}, 3.786116631301402*^9, 
   3.836462441469887*^9},
 CellLabel->
  "In[144]:=",ExpressionUUID->"83418f5d-b44a-4775-b87f-5d0269a12239"],

Cell[BoxData[
 RowBox[{"(*", " ", "BMA", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.784730235786085*^9, 3.784730239523982*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"8b3e745a-12d1-48dd-9d16-c23c7a42feaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bma", "[", 
    RowBox[{"y_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{
      RowBox[{"xbuenos", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ",", 
      RowBox[{"nbuenos", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ",", "t0", ",", "y"}], "]"}], "/", 
    RowBox[{"Pred", "[", 
     RowBox[{
      RowBox[{"xbuenos", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ",", 
      RowBox[{"nbuenos", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784715801367998*^9, 3.7847158492670107`*^9}, {
  3.784730230796569*^9, 3.784730232818877*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"d9ed8b81-fd03-408f-82fe-3aeb83a880b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"s", "[", "z_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"bma", "[", 
       RowBox[{"z", ",", "j"}], "]"}], "*", 
      RowBox[{"posterior", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "Numberofmodels"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7847158669235363`*^9, 3.784715928952038*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"4739df3a-16e6-4917-b214-bd165110a9a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalD]T", "=", 
   RowBox[{"ProbabilityDistribution", "[", 
    RowBox[{
     RowBox[{"s", "[", "y", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784728644591082*^9, 3.784728648313879*^9}, {
  3.784728973258445*^9, 3.784728973725857*^9}, {3.785257530572927*^9, 
  3.7852575312432747`*^9}, {3.8364608380778923`*^9, 3.836460839253284*^9}, {
  3.8364627831988363`*^9, 3.836462784773224*^9}, {3.836542794872357*^9, 
  3.83654279547824*^9}, {3.836542934881136*^9, 3.8365429354643803`*^9}, {
  3.836568423564686*^9, 3.836568424114156*^9}, {3.836568766965115*^9, 
  3.836568767526698*^9}, {3.8374964253227797`*^9, 3.837496425804923*^9}, {
  3.8374965177123613`*^9, 3.837496518270862*^9}, {3.837497193564329*^9, 
  3.837497194158942*^9}, {3.837497308360507*^9, 3.837497308832006*^9}, {
  3.843714550387416*^9, 3.843714551607368*^9}, {3.8437152521090117`*^9, 
  3.843715252556329*^9}, {3.843715300290444*^9, 3.843715301309947*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"c6bc1845-9938-41c6-a66f-70fda6536b87"],

Cell[BoxData[
 RowBox[{"g2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"PDF", "[", 
     RowBox[{"\[ScriptCapitalD]C", ",", "y"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", "0.8"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.78472869026941*^9, 3.78472869167237*^9}, {
  3.784728982851787*^9, 3.784728991174721*^9}, {3.836460832926002*^9, 
  3.836460833477124*^9}, {3.83646278743785*^9, 3.836462787901125*^9}, {
  3.83654279792623*^9, 3.836542798414856*^9}, {3.836542937570766*^9, 
  3.8365429390198507`*^9}, {3.836568426096438*^9, 3.8365684278717737`*^9}, {
  3.836568607528947*^9, 3.836568613478476*^9}, {3.836568770544195*^9, 
  3.836568771003283*^9}, {3.8374964328604794`*^9, 3.837496433365677*^9}, {
  3.8374965218163157`*^9, 3.837496526066882*^9}, {3.83749719714227*^9, 
  3.837497200954368*^9}, {3.837497311736804*^9, 3.837497314311507*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"2e4a6c9b-f1a3-498c-b2cb-56dd6585c0ef"],

Cell[BoxData[
 RowBox[{"graf1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{"\[ScriptCapitalD]C", ",", "y"}], "]"}], ",", 
      RowBox[{"PDF", "[", 
       RowBox[{"\[ScriptCapitalD]T", ",", "y"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", "0.35"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "14"}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Dashed", ",", "Thick"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.78473028876381*^9, 3.784730345738003*^9}, {
  3.8364608632144117`*^9, 3.8364608637091846`*^9}, {3.8365430526713877`*^9, 
  3.836543053591778*^9}, {3.8365689510496283`*^9, 3.8365689803885183`*^9}, {
  3.837496553642968*^9, 3.837496604357348*^9}, {3.837497325904414*^9, 
  3.8374973313683147`*^9}, {3.843715337959918*^9, 3.8437153545115147`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"4f95fbfc-587d-4940-8aa2-8599cde3711e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "2021", "]"}], ";", 
  RowBox[{"data1", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"\[ScriptCapitalD]T", ",", 
     RowBox[{"10", "^", "4"}], ",", 
     RowBox[{"WorkingPrecision", "\[Rule]", "7"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.836543473748226*^9, 3.8365435060853*^9}, {
  3.836543756217019*^9, 3.836543762729195*^9}, {3.836544146205731*^9, 
  3.836544149748151*^9}, {3.836544306681987*^9, 3.8365443088713293`*^9}, {
  3.836544350512416*^9, 3.836544350755702*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"cd9cce59-ed23-4707-8642-5b566447deae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "0", "]"}], ";", 
  RowBox[{"data2", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"\[ScriptCapitalD]C", ",", 
     RowBox[{"10", "^", "4"}], ",", 
     RowBox[{"WorkingPrecision", "\[Rule]", "7"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.836543526061542*^9, 3.836543538726506*^9}, {
  3.8365437987879057`*^9, 3.836543803578691*^9}, {3.836544156836581*^9, 
  3.836544157116952*^9}, {3.836544315995926*^9, 3.8365443164089823`*^9}, {
  3.836544369353093*^9, 3.836544369711911*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"53053bc4-f80f-4966-a8e4-898d06f88e34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OR", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"data1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", "data1"}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"data2", "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", "data2"}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR", "=", 
   RowBox[{"data1", "/", "data2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.836543561616085*^9, 3.836543567932444*^9}, {
  3.836569057081509*^9, 3.836569077759098*^9}, {3.8365692018955936`*^9, 
  3.83656920999306*^9}, {3.843715486515996*^9, 3.843715502259728*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"b953eb5a-e266-4ece-8e20-e8d47824027e"],

Cell[BoxData[
 RowBox[{"graf2", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"Histogram", "[", 
    RowBox[{"OR", ",", "1100", ",", "\"\<PDF\>\"", ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "10"}], "}"}], ",", "All"}], "}"}]}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.836543934391945*^9, 3.836543963962613*^9}, {
  3.836544031499178*^9, 3.836544033476993*^9}, {3.836544325332206*^9, 
  3.836544336411192*^9}, {3.8365443892097397`*^9, 3.836544394608727*^9}, {
  3.836544432816012*^9, 3.836544473934012*^9}, {3.836544524517387*^9, 
  3.8365445250771723`*^9}, {3.836569155499744*^9, 3.836569268528989*^9}, {
  3.8374974069475737`*^9, 3.837497408857746*^9}, {3.843714613306136*^9, 
  3.84371464285821*^9}, {3.8437156258282948`*^9, 3.843715653680511*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"3bfbe788-226f-45c4-8eba-fec5ac636dfe"],

Cell[BoxData[
 RowBox[{"graf2", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"Histogram", "[", 
    RowBox[{"RR", ",", "2100", ",", "\"\<PDF\>\"", ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "10"}], "}"}], ",", "All"}], "}"}]}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.843715522580586*^9, 3.843715552205459*^9}, {
  3.843715705298994*^9, 3.843715717066387*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"a8d5a155-78c8-4ee2-b1c0-bb6d9fcd730f"]
},
WindowSize->{1219, 1278},
WindowMargins->{{258, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.3 para Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6e2025ff-c065-4228-9825-f9b8ee8b1058"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 273, 6, 74, "Input",ExpressionUUID->"84e9788a-9fe1-4f04-a8c7-0e72f074e507"],
Cell[834, 28, 7662, 117, 277, "Input",ExpressionUUID->"265b960a-c5c1-459e-b1ee-f306a34ad1dc"],
Cell[8499, 147, 297, 6, 74, "Input",ExpressionUUID->"6ba73300-d440-4151-bfb0-a9bbfb27dad0"],
Cell[8799, 155, 221, 5, 46, "Input",ExpressionUUID->"f723fa7e-d9f5-43ec-9982-9a0981e80daa"],
Cell[9023, 162, 1655, 40, 202, "Input",ExpressionUUID->"dc95f351-a071-4460-a7af-00a4291e3458"],
Cell[10681, 204, 572, 12, 46, "Input",ExpressionUUID->"202d8811-faf5-4ef7-b56c-bbd1f164b1d1"],
Cell[11256, 218, 825, 24, 78, "Input",ExpressionUUID->"9da70d02-c61e-415e-bdb6-c15c5368fef1"],
Cell[12084, 244, 238, 4, 77, "Text",ExpressionUUID->"43284547-e832-4a8f-a6d3-35116f3472d2"],
Cell[12325, 250, 3635, 91, 171, "Input",ExpressionUUID->"f6f6e041-3b83-4b9b-9bc3-6312c89cdbe2"],
Cell[15963, 343, 922, 19, 46, "Input",ExpressionUUID->"0669bf90-4739-4f97-aefd-f4afaec63a2c"],
Cell[16888, 364, 331, 7, 74, "Input",ExpressionUUID->"1cb5b4e4-97c8-45b4-925f-1c5ac3763b33"],
Cell[17222, 373, 457, 11, 46, "Input",ExpressionUUID->"39de7ffb-8297-40da-9311-6ddd05473359"],
Cell[17682, 386, 1847, 46, 171, "Input",ExpressionUUID->"d0c5718f-8d59-4603-a9c9-72d4d4bb03e7"],
Cell[19532, 434, 341, 7, 74, "Input",ExpressionUUID->"ca094328-2d2e-4279-b3e6-a33b821335e0"],
Cell[19876, 443, 1343, 23, 78, "Input",ExpressionUUID->"9e29cdf6-b450-4790-90ef-f67003946c94"],
Cell[21222, 468, 1308, 28, 78, "Input",ExpressionUUID->"83418f5d-b44a-4775-b87f-5d0269a12239"],
Cell[22533, 498, 212, 4, 46, "Input",ExpressionUUID->"8b3e745a-12d1-48dd-9d16-c23c7a42feaa"],
Cell[22748, 504, 750, 21, 46, "Input",ExpressionUUID->"d9ed8b81-fd03-408f-82fe-3aeb83a880b7"],
Cell[23501, 527, 540, 16, 46, "Input",ExpressionUUID->"4739df3a-16e6-4917-b214-bd165110a9a1"],
Cell[24044, 545, 1136, 20, 46, "Input",ExpressionUUID->"c6bc1845-9938-41c6-a66f-70fda6536b87"],
Cell[25183, 567, 1076, 20, 46, "Input",ExpressionUUID->"2e4a6c9b-f1a3-498c-b2cb-56dd6585c0ef"],
Cell[26262, 589, 1045, 24, 78, "Input",ExpressionUUID->"4f95fbfc-587d-4940-8aa2-8599cde3711e"],
Cell[27310, 615, 630, 13, 46, "Input",ExpressionUUID->"cd9cce59-ed23-4707-8642-5b566447deae"],
Cell[27943, 630, 631, 13, 46, "Input",ExpressionUUID->"53053bc4-f80f-4966-a8e4-898d06f88e34"],
Cell[28577, 645, 720, 20, 78, "Input",ExpressionUUID->"b953eb5a-e266-4ece-8e20-e8d47824027e"],
Cell[29300, 667, 929, 19, 46, "Input",ExpressionUUID->"3bfbe788-226f-45c4-8eba-fec5ac636dfe"],
Cell[30232, 688, 539, 14, 46, "Input",ExpressionUUID->"a8d5a155-78c8-4ee2-b1c0-bb6d9fcd730f"]
}
]
*)

